!function($){var methods={init:function(e){var l=$(this).prop("id");(e=$.extend({columns:[],colHeaders:[],colWidths:[],colAlignments:[],colHeaderClasses:[],defaultColWidth:50,minSpareRows:0,minSpareCols:0,minDimensions:[0,0],contextMenu:null,columnSorting:!0,columnResize:!0,rowDrag:!0,editable:!0,allowInsertRow:!0,allowManualInsertRow:!0,allowInsertColumn:!0,allowManualInsertColumn:!0,allowDeleteRow:!0,allowDeleteColumn:!0,allowComments:!0,wordWrap:!1,csvFileName:"jexcel",selectionCopy:!0,tableOverflow:!1,tableHeight:200,toolbar:null,about:"jExcel Spreadsheet\\nVersion 2.1.0\\nAuthor: Paul Hodel <paul.hodel@gmail.com>\\nWebsite: https://bossanova.uk/jexcel"},e)).div=this,null!=e.manualColumnResize&&(e.columnResize=e.manualColumnResize),null!=e.manualRowMove&&(e.rowDrag=e.manualRowMove),$.fn.jexcel.defaults||($.fn.jexcel.ignoreEvents=!1,$.fn.jexcel.ignoreHistory=!1,$.fn.jexcel.defaults=[],$.fn.jexcel.factory=function(e,l){this.k=e,this.v=l},$.fn.jexcel.factory.prototype.toString=function(){return $.fn.jexcel.current?$.fn.jexcel.defaults[$.fn.jexcel.current].values[this.k]:this.v},$.fn.jexcel.hash=null,$.fn.jexcel.style=null),$.fn.jexcel.defaults[l]=e,$.fn.jexcel.defaults[l].data||($.fn.jexcel.defaults[l].data=[]),$.fn.jexcel.defaults[l].data.length||($.fn.jexcel.defaults[l].data=[[]]),$.fn.jexcel.defaults[l].history=[],$.fn.jexcel.defaults[l].historyIndex=-1,$.fn.jexcel.defaults[l].csv?$.csv?($.fn.jexcel.defaults[l].delimiter=$.fn.jexcel.defaults[l].delimiter||",",$.ajax({id:l,url:$.fn.jexcel.defaults[l].csv,success:function(e){var l=$.csv.toArrays(e);1==$.fn.jexcel.defaults[this.id].csvHeaders&&($.fn.jexcel.defaults[this.id].colHeaders=l.shift()),$.fn.jexcel.defaults[this.id].data=l,$.fn.jexcel("prepareTable",this.id)}})):console.error("Jexcel error: jquery-csv library not loaded"):e.url?$.ajax({id:l,url:$.fn.jexcel.defaults[l].url,dataType:"json",success:function(e){$.fn.jexcel.defaults[this.id].data=e.data?e.data:e,$.fn.jexcel("prepareTable",this.id)}}):$.fn.jexcel("prepareTable",l)},prepareTable:function(e){var l=[],t=$.fn.jexcel.defaults[e].colHeaders.length;$.fn.jexcel.defaults[e].data[0].length>t&&(t=$.fn.jexcel.defaults[e].data[0].length),$.fn.jexcel.defaults[e].minDimensions[0]>t&&(t=$.fn.jexcel.defaults[e].minDimensions[0]);for(var n=0;n<t;n++)$.fn.jexcel.defaults[e].colHeaders[n]||($.fn.jexcel.defaults[e].colHeaders[n]=""),$.fn.jexcel.defaults[e].columns[n]?$.fn.jexcel.defaults[e].columns[n]||($.fn.jexcel.defaults[e].columns[n].type="text"):$.fn.jexcel.defaults[e].columns[n]={type:"text"},$.fn.jexcel.defaults[e].columns[n].source||($.fn.jexcel.defaults[e].columns[n].source=[]),$.fn.jexcel.defaults[e].columns[n].options||($.fn.jexcel.defaults[e].columns[n].options=[]),$.fn.jexcel.defaults[e].columns[n].editor||($.fn.jexcel.defaults[e].columns[n].editor=null),$.fn.jexcel.defaults[e].columns[n].allowEmpty||($.fn.jexcel.defaults[e].columns[n].allowEmpty=!1),$.fn.jexcel.defaults[e].colWidths[n]||($.fn.jexcel.defaults[e].colWidths[n]=$.fn.jexcel.defaults[e].defaultColWidth||"50"),$.fn.jexcel.defaults[e].colAlignments[n]||($.fn.jexcel.defaults[e].colAlignments[n]="center"),$.fn.jexcel.defaults[e].colHeaderClasses[n]||($.fn.jexcel.defaults[e].colHeaderClasses[n]=""),"autocomplete"==$.fn.jexcel.defaults[e].columns[n].type||"dropdown"==$.fn.jexcel.defaults[e].columns[n].type?$.fn.jexcel.defaults[e].columns[n].url&&l.push($.ajax({id:e,url:$.fn.jexcel.defaults[e].columns[n].url,index:n,dataType:"json",success:function(e){$.fn.jexcel.defaults[this.id].columns[this.index].source=e},error:function(e){console.error("It was not possible to load the url: "+this.url)}})):"calendar"==$.fn.jexcel.defaults[e].columns[n].type&&($.fn.jexcel.defaults[e].columns[n].options.format||($.fn.jexcel.defaults[e].columns[n].options.format="DD/MM/YYYY"));0<l.length?$.when.apply(this,l).done(function(){$($.fn.jexcel.defaults[e].div).jexcel("createTable")}):$($.fn.jexcel.defaults[e].div).jexcel("createTable")},createTable:function(){var s=$(this).prop("id"),e=$.fn.jexcel.defaults[s];if($(this).prop("class","jexcel"),e.toolbar&&e.toolbar.length){var c=document.createElement("div");$(c).css("display","nonex"),$(c).prop("class","jexcel-toolbar"),$.each(e.toolbar,function(e,l){if("i"==l.type){if(l.method)var t=function(){l.method($("#"+$.fn.jexcel.current),$.fn.jexcel("getSelectedCells"))};else t=function(){$("#"+$.fn.jexcel.current).jexcel("setStyle",$.fn.jexcel("getSelectedCells"),l.k,l.v)};var n=document.createElement("i");$(n).prop("class","jexcel-toolbar-item material-icons"),$(n).on("click",t),$(n).html(l.content),$(c).append(n)}else if("select"==l.type){n=document.createElement("select");$(n).prop("class","jexcel-toolbar-item"),$(n).on("change",function(){$("#"+$.fn.jexcel.current).jexcel("setStyle",$.fn.jexcel("getSelectedCells"),l.k,this.value)}),"string"==typeof l.v[0]&&$.each(l.v,function(e,l){var t=document.createElement("option");$(t).prop("value",l),$(t).html(l),$(n).append(t)}),$(c).append(n)}else if("spectrum"==l.type){n=document.createElement("input");$(c).append(n),$(n).spectrum({showButtons:!1,move:function(e){$("#"+$.fn.jexcel.current).jexcel("setStyle",$.fn.jexcel("getSelectedCells"),l.k,e.toHexString())}})}})}var l=document.createElement("div");$(l).prop("class","jexcel-header");var t=document.createElement("div");$(t).prop("class","jexcel-content");var n=document.createElement("table");$(n).prop("cellpadding","0"),$(n).prop("cellspacing","0"),$(n).prop("unselectable","yes"),$(n).prop("onselectstart","return false");var o=document.createElement("thead"),r=document.createElement("tbody");$(o).prop("class","jexcel_label");var a="",i="",f="";if(e.nestedHeaders&&0<e.nestedHeaders.length){function d(e){a="<td></td>";for(var l=0,t=0;t<e.length;t++){e[t].colspan||(e[t].colspan=1),e[t].align||(e[t].align="center"),e[t].title||(e[t].title="");for(var n="",c=0;c<e[t].colspan;c++)n&&(n+=" "),n+="h"+l,l++;a+='<td class="'+n+'" colspan="'+e[t].colspan+'" align="'+e[t].align+'">'+e[t].title+"</td>"}return'<tr class="jexcel_nested">'+a+"</tr>"}e.nestedHeaders[0]&&e.nestedHeaders[0][0]?$.each(e.nestedHeaders,function(e,l){i+=d(l)}):i+=d(e.nestedHeaders)}a="<td></td>";for(var u=0;u<e.colHeaders.length;u++){var p=e.colWidths[u],x=e.colAlignments[u]||"center",j="";e.colHeaderClasses[u]&&(j+=e.colHeaderClasses[u]);var h="hidden"==e.columns[u].type?' style="display:none"':"",m=e.colHeaders[u],g=m||$.fn.jexcel("getColumnName",u);f+='<col width="'+p+'">',a+='<td id="col-'+u+'" align="'+x+'" title="'+m+'" class="'+j+'"'+h+">"+g+"</td>",'<td><input placeholder="Filter:"></td>'}$(o).append('<tr class="jexcel_headers_nested">'+i+"</tr>"),$(o).append('<tr class="jexcel_headers">'+a+"</tr>"),$(n).append('<colgroup><col width="30">'+f+"</colgroup>"),$(n).append(o),$(l).append(n);var v=document.createElement("table");if($(v).prop("cellpadding","0"),$(v).prop("cellspacing","0"),$(v).prop("unselectable","yes"),$(v).prop("onselectstart","return false"),$(v).append('<colgroup><col width="30">'+f+"</colgroup>"),$(v).append(r),$(t).html(v),1==$.fn.jexcel.defaults[s].tableOverflow&&($.fn.jexcel.defaults[s].tableWidth&&($(t).css("overflow-x","scroll"),$(t).css("max-width",$.fn.jexcel.defaults[s].tableWidth)),$.fn.jexcel.defaults[s].tableHeight?($(t).css("overflow-y","scroll"),$(t).css("max-height",$.fn.jexcel.defaults[s].tableHeight),$.fn.jexcel.defaults[s].tableWidth&&($(l).css("overflow-x","hidden"),$(l).css("max-width",parseInt($.fn.jexcel.defaults[s].tableWidth)-17))):$.fn.jexcel.defaults[s].tableWidth&&($(l).css("overflow-x","hidden"),$(l).css("max-width",$.fn.jexcel.defaults[s].tableWidth))),$(this).html(c),$(this).append(l),$(this).append(t),!$(".jexcel_corner").length){var C=document.createElement("div");$(C).prop("class","jexcel_corner jexcel"),$(C).prop("id","jexcel_corner"),0==e.selectionCopy&&$(C).css("display","none");var y=document.createElement("textarea");$(y).prop("class","jexcel_textarea"),$(y).prop("id","jexcel_textarea");var w=document.createElement("div");$(w).css("display","none"),$(w).prop("class","jexcel_contextmenu"),$(w).prop("id","jexcel_contextmenu");var b=document.createElement("div");$(b).css("display","none"),$(b).prop("id","jexcel_about"),$(b).prop("class","jexcel_about"),$(b).html('<a href="https://github.com/paulhodel/jexcel">jExcel Spreadsheet</a>'),$("body").append(C),$("body").append(y),$("body").append(w),$("body").append(b),$(C).prop("unselectable","on"),$(C).prop("onselectstart","return false"),$.fn.jexcel.dragStartControls=function(e){$(e.target).prop("id")},$.fn.jexcel.selectedCorner=!1,$.fn.jexcel.selectedHeader=null,$.fn.jexcel.resizeColumn=null,$.fn.jexcel.contextMenuControls=function(e){if($($.fn.jexcel.selectedCell).hasClass("edition"))e.preventDefault();else if("block"==$("#jexcel_contextmenu").css("display")&&$("#jexcel_contextmenu").css("display","none"),$.fn.jexcel.current&&!!$(e.target).parents(".jexcel").length){if($(e.target).parent().is(".jexcel_headers"))var l=$(e.target).prop("id");else l=$(e.target).parent().prop("id");l&&(l=l.split("-"),contextMenuContent="","function"==typeof $.fn.jexcel.defaults[$.fn.jexcel.current].contextMenu?contextMenuContent=$.fn.jexcel.defaults[$.fn.jexcel.current].contextMenu(l[0],l[1],e):contextMenuContent=$.fn.jexcel("contextMenu",l[0],l[1],e),contextMenuContent&&($("#jexcel_contextmenu").html(contextMenuContent),$("#jexcel_contextmenu").css({display:"block",top:e.pageY+"px",left:e.pageX+"px"}),e.preventDefault()))}},$(document).on("contextmenu",$.fn.jexcel.contextMenuControls),$.fn.jexcel.mouseWheelControls=function(e){$(".jexcel_contextmenu").css("display","none")},$(document).on("mousewheel",$.fn.jexcel.mouseWheelControls),$.fn.jexcel.mouseDownControls=function(l){if(3!=l.which)if("jexcel_corner"==l.target.id)1==$.fn.jexcel.defaults[$.fn.jexcel.current].editable&&($.fn.jexcel.selectedCorner=!0);else{var e=$(l.target).parents(".jexcel");if(0<$(e).length){var t=$(e).prop("id");if($.fn.jexcel.current&&$.fn.jexcel.current!=t&&$("#"+$.fn.jexcel.current).jexcel("updateSelection"),$.fn.jexcel.current=t,$(l.target).parent().is(".jexcel_headers")){if(i=$(l.target).prop("id")){if(i=i.split("-"),$.fn.jexcel.selectedHeader&&(l.shiftKey||l.ctrlKey))var n=$($.fn.jexcel.selectedHeader).prop("id").split("-");else{n=$(l.target).prop("id").split("-");$.fn.jexcel.selectedHeader=$(l.target),$.fn.jexcel.selectedRow=null}if($(l.target).outerWidth()-l.offsetX<8)1==$.fn.jexcel.defaults[$.fn.jexcel.current].columnResize&&($.fn.jexcel.resizeColumn={mousePosition:l.pageX,column:i[1],width:parseInt($(l.target).css("width"))},$("#"+$.fn.jexcel.current+" .c"+i[1]).addClass("resizing"),$("#"+$.fn.jexcel.current+" .h"+i[1]).addClass("resizing"),$("#"+$.fn.jexcel.current+" #col-"+i[1]).addClass("resizing"),$("#"+$.fn.jexcel.current).jexcel("updateSelection"),$(".jexcel_corner").css("left","-200px"));else{var c=$("#"+$.fn.jexcel.current).find("#"+i[1]+"-0"),o=$("#"+$.fn.jexcel.current).find("#"+n[1]+"-"+parseInt($.fn.jexcel.defaults[$.fn.jexcel.current].data.length-1));$("#"+$.fn.jexcel.current).jexcel("updateSelection",c,o,1),$.fn.jexcel.selectedCell=$(c)}}}else $.fn.jexcel.selectedHeader=!1;if($(l.target).parent().is(".jexcel_nested")){var s=$(l.target).prop("class").split(" "),r="";if($.each(s,function(e,l){"h"==l.substr(0,1)&&(r&&(r+=", "),r+=".c"+l.substr(1))}),r){s=$("#"+$.fn.jexcel.current).find(r),c=$(s).first(),o=$(s).last();$("#"+$.fn.jexcel.current).jexcel("updateSelection",c,o,1),$.fn.jexcel.selectedCell=$(c)}}if($(l.target).parents(".jexcel-content").length){var a="TD"==l.target.tagName?l.target:$(l.target).parents("td");if($(a).length&&$(a).prop("id"))if($(l.target).is(".jexcel_label"))if(1==$.fn.jexcel.defaults[$.fn.jexcel.current].rowDrag&&$(l.target).outerWidth()-l.offsetX<8)$("#"+$.fn.jexcel.current).jexcel("resetSelection"),$.fn.jexcel.dragRowFrom=$(l.target).parent().prop("id"),$.fn.jexcel.dragRowOver=$(l.target).parent().prop("id"),$(l.target).parent().find("td").css("background-color","rgba(0,0,0,0.1)");else{var i=$(l.target).parent().prop("id").split("-");if($.fn.jexcel.selectedRow&&(l.shiftKey||l.ctrlKey))n=$($.fn.jexcel.selectedRow).prop("id").split("-");else{n=$(l.target).parent().prop("id").split("-");$.fn.jexcel.selectedRow=$(l.target).parent(),$.fn.jexcel.selectedHeader=null}c=$("#"+$.fn.jexcel.current).find("#0-"+i[1]),o=$("#"+$.fn.jexcel.current).find("#"+parseInt($.fn.jexcel.defaults[$.fn.jexcel.current].columns.length-1)+"-"+n[1]);$("#"+$.fn.jexcel.current).jexcel("updateSelection",c,o),$.fn.jexcel.selectedCell=$(o)}else $(l.target).parents(".edition").length?$(a)!=$.fn.jexcel.selectedCell&&($.fn.jexcel.selectedCell=$(a),$("#"+$.fn.jexcel.current).jexcel("updateSelection",$.fn.jexcel.selectedCell,$(a))):($.fn.jexcel.selectedCell&&l.shiftKey||($.fn.jexcel.selectedCell=$(a)),$("#"+$.fn.jexcel.current).jexcel("updateSelection",$.fn.jexcel.selectedCell,$(a))),$.fn.jexcel.touchControls=setTimeout(function(){if(1==$.fn.jexcel.defaults[$.fn.jexcel.current].editable&&$(l.target).parents(".jexcel-content").length){var e="TD"==l.target.tagName?l.target:$(l.target).parents("td");$(e).is(".highlight")&&$("#"+$.fn.jexcel.current).jexcel("openEditor",$(e),null,l)}},500),$.fn.jexcel.selectedRow=null}}else $(l.target).parents(".jexcel, .jexcel_contextmenu").length||l.target!=$("html").get(0)&&$("#"+$.fn.jexcel.current).jexcel("resetSelection")}},$(document).on("mousedown touchstart",$.fn.jexcel.mouseDownControls),$.fn.jexcel.mouseUpControls=function(e){if("jexcel_arrow"==e.target.id)$.fn.jexcel.current||($.fn.jexcel.current=$(e.target).parents(".jexcel").parent().prop("id")),$.fn.jexcel.selectedCell=$(e.target).parent().parent(),$("#"+$.fn.jexcel.current).jexcel("updateSelection",$.fn.jexcel.selectedCell,$.fn.jexcel.selectedCell),$("#"+$.fn.jexcel.current).jexcel("openEditor",$.fn.jexcel.selectedCell,null,e);else{if(3!=e.which&&$("#jexcel_contextmenu").css("display","none"),$.fn.jexcel.selectedCorner=!1,$.fn.jexcel.resizeColumn){$("#"+$.fn.jexcel.current+" .h"+$.fn.jexcel.resizeColumn.column).removeClass("resizing"),$("#"+$.fn.jexcel.current+" .c"+$.fn.jexcel.resizeColumn.column).removeClass("resizing"),$("#"+$.fn.jexcel.current+" #col-"+$.fn.jexcel.resizeColumn.column).removeClass("resizing");var l=$("#"+$.fn.jexcel.current+" .jexcel-header col").eq(parseInt($.fn.jexcel.resizeColumn.column)+1).prop("width");$("#"+$.fn.jexcel.current).jexcel("setWidth",$.fn.jexcel.resizeColumn.column,l),"function"==typeof $.fn.jexcel.defaults[$.fn.jexcel.current].onresize&&$.fn.jexcel.defaults[$.fn.jexcel.current].onresize($(this),$.fn.jexcel.resizeColumn.column,l,$.fn.jexcel.resizeColumn.width),$.fn.jexcel.resizeColumn=null}var t=$("#"+$.fn.jexcel.current).find("tbody td.selection");if(0<$(t).length){var n=$(t[0]).prop("id").split("-"),c=$(t[t.length-1]).prop("id").split("-");$("#"+$.fn.jexcel.current).jexcel("copyData",n,c),$(t).removeClass("selection selection-left selection-right selection-top selection-bottom")}}if($.fn.jexcel.dragRowFrom){if($.fn.jexcel.dragRowFrom!=$.fn.jexcel.dragRowOver){var o=$.fn.jexcel.dragRowFrom.split("-"),s=$.fn.jexcel.dragRowOver.split("-");$("#"+$.fn.jexcel.current).jexcel("moveRow",o[1],s[1])}$("#"+$.fn.jexcel.dragRowFrom).css("cursor",""),$("#"+$.fn.jexcel.dragRowOver).css("cursor",""),$("#"+$.fn.jexcel.current+" #"+$.fn.jexcel.dragRowOver).parent().find("td").css("background-color","")}$.fn.jexcel.dragRowFrom=null,$.fn.jexcel.dragRowOver=null,$.fn.jexcel.touchControls&&clearTimeout($.fn.jexcel.touchControls)},$(document).on("mouseup",$.fn.jexcel.mouseUpControls),$.fn.jexcel.touchControls=null,$.fn.jexcel.touchCancelControls=function(){$.fn.jexcel.touchControls&&clearTimeout($.fn.jexcel.touchControls)},$(document).on("touchend touchcancel touchmove",$.fn.jexcel.touchCancelControls),$.fn.jexcel.doubleClickControls=function(e){if($.fn.jexcel.current){if(1==$.fn.jexcel.defaults[$.fn.jexcel.current].editable)if("jexcel_corner"==e.target.id){var l=$("#"+$.fn.jexcel.current).find("tbody td.highlight");if("object"==typeof l){var t=$(l[0]).prop("id").split("-"),n=$(l[l.length-1]).prop("id").split("-");t[1]=parseInt(n[1])+1,n[1]=parseInt($.fn.jexcel.defaults[$.fn.jexcel.current].data.length),$("#"+$.fn.jexcel.current).jexcel("copyData",t,n)}}else if($(e.target).parents(".jexcel-content").length){var c="TD"==e.target.tagName?e.target:$(e.target).parents("td");$(c).is(".highlight")&&$("#"+$.fn.jexcel.current).jexcel("openEditor",$(c),null,e)}if(1==$.fn.jexcel.defaults[$.fn.jexcel.current].columnSorting)if($(e.target).parent().parent().is("thead"))(t=$(e.target).prop("id"))&&(t=$(e.target).prop("id").split("-"),$("#"+$.fn.jexcel.current).jexcel("orderBy",t[1]))}},$(document).on("dblclick",$.fn.jexcel.doubleClickControls),$.fn.jexcel.mouseMoveControls=function(e){if($.fn.jexcel.current){if(1==$.fn.jexcel.defaults[$.fn.jexcel.current].columnResize)if($.fn.jexcel.resizeColumn){var l=e.pageX-$.fn.jexcel.resizeColumn.mousePosition;if(0<$.fn.jexcel.resizeColumn.width+l){var t=$.fn.jexcel.resizeColumn.width+l;$("#"+$.fn.jexcel.current).find(".jexcel-header col").eq(parseInt($.fn.jexcel.resizeColumn.column)+1).prop("width",t)}}else $(e.target).parent().is(".jexcel_headers")&&($(e.target).outerWidth()-e.offsetX<8&&""!=$(e.target).prop("id")?$(e.target).css("cursor","col-resize"):"col-resize"==$(e.target).css("cursor")&&$(e.target).css("cursor",""));1==$.fn.jexcel.defaults[$.fn.jexcel.current].rowDrag&&$(e.target).parent().parent().is("tbody")&&$(e.target).is(".jexcel_label")&&($(e.target).outerWidth()-e.offsetX<8?$(e.target).css("cursor","all-scroll"):"all-scroll"==$(e.target).css("cursor")&&$(e.target).css("cursor",""))}$.fn.jexcel.dragRowFrom?$("body").css("cursor","all-scroll"):"all-scroll"==$("body").css("cursor")&&$("body").css("cursor",""),$.fn.jexcel.touchControls&&clearTimeout($.fn.jexcel.touchControls)},$(document).on("mousemove",$.fn.jexcel.mouseMoveControls),$.fn.jexcel.mouseOverControls=function(e){if(!$.fn.jexcel.resizeColumn){var l=$(e.target).closest(".jexcel");if($.fn.jexcel.current==$(l).prop("id")){if($(e.target).parent().is(".jexcel_headers")&&$.fn.jexcel.selectedHeader&&e.buttons){var t=$($.fn.jexcel.selectedHeader).prop("id"),n=$(e.target).prop("id");if(t&&n){t=t.split("-"),n=n.split("-");var c=$("#"+$.fn.jexcel.current).find("#"+t[1]+"-0"),o=$("#"+$.fn.jexcel.current).find("#"+n[1]+"-"+parseInt($.fn.jexcel.defaults[$.fn.jexcel.current].data.length-1));$("#"+$.fn.jexcel.current).jexcel("updateSelection",c,o)}}if($(e.target).parent().parent().is("tbody"))if($(e.target).is(".jexcel_label"))if($.fn.jexcel.selectedRow){if(e.buttons){t=$($.fn.jexcel.selectedRow).prop("id"),n=$(e.target).parent().prop("id");if(t&&n){t=t.split("-"),n=n.split("-");c=$("#"+$.fn.jexcel.current).find("#0-"+t[1]),o=$("#"+$.fn.jexcel.current).find("#"+parseInt($.fn.jexcel.defaults[$.fn.jexcel.current].columns.length-1)+"-"+n[1]);$("#"+$.fn.jexcel.current).jexcel("updateSelection",c,o)}}}else $.fn.jexcel.dragRowFrom&&($("#"+$.fn.jexcel.current+" #"+$.fn.jexcel.dragRowOver).parent().find("td").css("background-color",""),$(e.target).parent().find("td").css("background-color","rgba(0,0,0,0.1)"),$.fn.jexcel.dragRowOver=$(e.target).parent().prop("id"));else $.fn.jexcel.selectedCell&&($($.fn.jexcel.selectedCell).hasClass("edition")||(1==$.fn.jexcel.selectedCorner?$("#"+$.fn.jexcel.current).jexcel("updateCornerSelection",$(e.target)):e.buttons&&$("#"+$.fn.jexcel.current).jexcel("updateSelection",$.fn.jexcel.selectedCell,$(e.target)))),1!=$.fn.jexcel.ignoreEvents&&$.fn.jexcel.defaults[s].onmouseover&&"function"==typeof $.fn.jexcel.defaults[s].onmouseover&&$.fn.jexcel.defaults[s].onmouseover($("#"+$.fn.jexcel.current),$(e.target))}}},$(document).on("mouseover",$.fn.jexcel.mouseOverControls),$.fn.jexcel.pasteControls=function(e){$.fn.jexcel.selectedCell&&($($.fn.jexcel.selectedCell).hasClass("edition")||e.originalEvent&&(1==$.fn.jexcel.defaults[$.fn.jexcel.current].editable&&$("#"+$.fn.jexcel.current).jexcel("paste",$.fn.jexcel.selectedCell,e.originalEvent.clipboardData.getData("text")),e.preventDefault()))},$(document).on("paste",$.fn.jexcel.pasteControls),$.fn.jexcel.keyDownControls=function(e){if($.fn.jexcel.current){var l=null;if($.fn.jexcel.selectedCell){if(columnId=$($.fn.jexcel.selectedCell).prop("id").split("-"),37==e.which)$($.fn.jexcel.selectedCell).hasClass("edition")||(e.ctrlKey?l=$($.fn.jexcel.selectedCell).parent().find("td").not(".jexcel_label").first():0<$.fn.jexcel("col")&&(l=$($.fn.jexcel.selectedCell).prev()),e.preventDefault());else if(39==e.which)$($.fn.jexcel.selectedCell).hasClass("edition")||(l=e.ctrlKey?$($.fn.jexcel.selectedCell).parent().find("td").last():$($.fn.jexcel.selectedCell).next(),e.preventDefault());else if(38==e.which)$($.fn.jexcel.selectedCell).hasClass("edition")||(l=e.ctrlKey?$($.fn.jexcel.selectedCell).parent().parent().find("tr").first().find("#"+columnId[0]+"-0"):$($.fn.jexcel.selectedCell).parent().prev().find("#"+columnId[0]+"-"+(columnId[1]-1)),e.preventDefault());else if(40==e.which)$($.fn.jexcel.selectedCell).hasClass("edition")||(l=e.ctrlKey?$($.fn.jexcel.selectedCell).parent().parent().find("tr").last().find("#"+columnId[0]+"-"+($.fn.jexcel.defaults[$.fn.jexcel.current].data.length-1)):$($.fn.jexcel.selectedCell).parent().next().find("#"+columnId[0]+"-"+(parseInt(columnId[1])+1)),e.preventDefault());else if(36==e.which)$($.fn.jexcel.selectedCell).hasClass("edition")||(l=e.shiftKey&&e.ctrlKey?$($.fn.jexcel.selectedCell).parent().parent().find("tr").first().find("td").not(".jexcel_label").first():$($.fn.jexcel.selectedCell).parent().find("td").not(".jexcel_label").first(),e.preventDefault());else if(35==e.which)$($.fn.jexcel.selectedCell).hasClass("edition")||(l=e.shiftKey&&e.ctrlKey?$($.fn.jexcel.selectedCell).parent().parent().find("tr").last().find("td").last():$($.fn.jexcel.selectedCell).parent().find("td").last(),e.preventDefault());else if(27==e.which)$($.fn.jexcel.selectedCell).hasClass("edition")&&$("#"+$.fn.jexcel.current).jexcel("closeEditor",$($.fn.jexcel.selectedCell),!1);else if(13==e.which){if($($.fn.jexcel.selectedCell).hasClass("edition"))if("calendar"==$.fn.jexcel.defaults[$.fn.jexcel.current].columns[columnId[0]].type)$("#"+$.fn.jexcel.current).find("editor").jcalendar("close",1);else if("dropdown"==$.fn.jexcel.defaults[$.fn.jexcel.current].columns[columnId[0]].type||"autocomplete"==$.fn.jexcel.defaults[$.fn.jexcel.current].columns[columnId[0]].type);else if(1==$.fn.jexcel.defaults[$.fn.jexcel.current].columns[columnId[0]].wordWrap&&e.altKey){var t=$($.fn.jexcel.selectedCell).find(".editor"),n=$(t).val(),c=$(t).prop("selectionStart");n=n.slice(0,c)+"\n"+n.slice(c),$(t).val(n),$(t).focus(),$(t).prop("selectionStart",c+1),$(t).prop("selectionEnd",c+1)}else $("#"+$.fn.jexcel.current).jexcel("closeEditor",$($.fn.jexcel.selectedCell),!0);$($.fn.jexcel.selectedCell).hasClass("edition")||(1==$.fn.jexcel.defaults[$.fn.jexcel.current].allowInsertRow&&1==$.fn.jexcel.defaults[$.fn.jexcel.current].allowManualInsertRow&&columnId[1]==$.fn.jexcel.defaults[$.fn.jexcel.current].data.length-1&&$("#"+$.fn.jexcel.current).jexcel("insertRow"),l=$($.fn.jexcel.selectedCell).parent().next().find("#"+columnId[0]+"-"+(parseInt(columnId[1])+1)),e.preventDefault())}else if(9==e.which)$($.fn.jexcel.selectedCell).hasClass("edition")&&("calendar"==$.fn.jexcel.defaults[$.fn.jexcel.current].columns[columnId[0]].type?$("#"+$.fn.jexcel.current).find("editor").jcalendar("close",1):$("#"+$.fn.jexcel.current).jexcel("closeEditor",$($.fn.jexcel.selectedCell),!0)),1==$.fn.jexcel.defaults[$.fn.jexcel.current].allowInsertColumn&&1==$.fn.jexcel.defaults[$.fn.jexcel.current].allowManualInsertColumn&&columnId[0]==$.fn.jexcel.defaults[$.fn.jexcel.current].data[0].length-1&&$("#"+$.fn.jexcel.current).jexcel("insertColumn"),$($.fn.jexcel.selectedCell).hasClass("edition")||(e.shiftKey?0<$.fn.jexcel("col")&&(l=$($.fn.jexcel.selectedCell).prev()):l=$($.fn.jexcel.selectedCell).next()),e.preventDefault();else if(46==e.which){if(1==$.fn.jexcel.defaults[$.fn.jexcel.current].editable&&!$($.fn.jexcel.selectedCell).hasClass("edition"))if($.fn.jexcel.selectedRow)1==$.fn.jexcel.defaults[$.fn.jexcel.current].allowDeleteRow&&confirm("Are you sure to delete the selected rows?")&&($("#"+$.fn.jexcel.current).jexcel("deleteRow"),$("#"+$.fn.jexcel.current).jexcel("resetSelection"));else if($.fn.jexcel.selectedHeader){if(1==$.fn.jexcel.defaults[$.fn.jexcel.current].allowDeleteColumn&&confirm("Are you sure to delete the selected columns?")){var o=$("#"+$.fn.jexcel.current).find("thead.jexcel_label").find(".selected");$("#"+$.fn.jexcel.current).jexcel("deleteColumn",parseInt($(o[0]).prop("id").split("-")[1]),parseInt(o.length))}}else $("#"+$.fn.jexcel.current).jexcel("setValue",$("#"+$.fn.jexcel.current).find(".highlight"),"")}else if(!e.metaKey||e.shiftKey||e.ctrlKey){if(e.ctrlKey){if(!e.shiftKey&&e.ctrlKey&&!$($.fn.jexcel.selectedCell).hasClass("edition"))if(65==e.which){var s=parseInt($.fn.jexcel.defaults[$.fn.jexcel.current].columns.length-1),r=parseInt($.fn.jexcel.defaults[$.fn.jexcel.current].data.length-1),a=$("#"+$.fn.jexcel.current).find("#0-0"),i=$("#"+$.fn.jexcel.current).find("#"+s+"-"+r);$("#"+$.fn.jexcel.current).jexcel("updateSelection",a,i),e.preventDefault()}else 83==e.which?($("#"+$.fn.jexcel.current).jexcel("download"),e.preventDefault()):89==e.which?($($.fn.jexcel.selectedCell).hasClass("edition")||$("#"+$.fn.jexcel.current).jexcel("redo"),e.preventDefault()):90==e.which?($($.fn.jexcel.selectedCell).hasClass("edition")||$("#"+$.fn.jexcel.current).jexcel("undo"),e.preventDefault()):67==e.which?($("#"+$.fn.jexcel.current).jexcel("copy",!0),e.preventDefault()):88==e.which?(1==$.fn.jexcel.defaults[$.fn.jexcel.current].editable?$("#"+$.fn.jexcel.current).jexcel("cut"):$("#"+$.fn.jexcel.current).jexcel("copy",!0),e.preventDefault()):86==e.which&&window.clipboardData&&(1==$.fn.jexcel.defaults[$.fn.jexcel.current].editable&&$("#"+$.fn.jexcel.current).jexcel("paste",$.fn.jexcel.selectedCell,window.clipboardData.getData("Text")),e.preventDefault())}else if($.fn.jexcel.selectedCell&&1==$.fn.jexcel.defaults[$.fn.jexcel.current].editable&&"readonly"!=$.fn.jexcel.defaults[$.fn.jexcel.current].columns[columnId[0]].type&&!$($.fn.jexcel.selectedCell).hasClass("edition"))if(32==e.keyCode)if("checkbox"==$.fn.jexcel.defaults[$.fn.jexcel.current].columns[columnId[0]].type||"radio"==$.fn.jexcel.defaults[$.fn.jexcel.current].columns[columnId[0]].type){var f=$("#"+$.fn.jexcel.current).jexcel("getValue",$.fn.jexcel.selectedCell);$("#"+$.fn.jexcel.current).jexcel("setValue",$.fn.jexcel.selectedCell,1!=f),e.preventDefault()}else $("#"+$.fn.jexcel.current).jexcel("openEditor",$($.fn.jexcel.selectedCell),!0,e);else 110==e.keyCode||48<=e.keyCode&&e.keyCode<=57||65<=e.keyCode&&e.keyCode<=90||96<=e.keyCode&&e.keyCode<=105||186<=e.keyCode&&e.keyCode<=190?$("#"+$.fn.jexcel.current).jexcel("openEditor",$($.fn.jexcel.selectedCell),!0,e):113==e.keyCode&&($("#"+$.fn.jexcel.current).jexcel("openEditor",$($.fn.jexcel.selectedCell),!1,e),e.preventDefault())}else $($.fn.jexcel.selectedCell).hasClass("edition")||67==e.which&&($("#"+$.fn.jexcel.current).jexcel("copy",!0),e.preventDefault());if(l&&0<$(l).length){if(e.shiftKey&&9!=e.which){$.fn.jexcel.referenceCell||($.fn.jexcel.referenceCell=$.fn.jexcel.selectedCell);a=$.fn.jexcel.referenceCell}else{$.fn.jexcel.referenceCell=null;a=l}var d=l;$.fn.jexcel.selectedCell=d,$("#"+$.fn.jexcel.current).jexcel("updateSelection",a,d)}}}},$(document).on("keydown",$.fn.jexcel.keyDownControls)}$(this).children(".jexcel-content").on("scroll",function(){$(this).jexcel("updateCornerPosition"),$(l).scrollLeft($(this).scrollLeft())}),$(this).jexcel("setData",$.fn.jexcel.defaults[s].data);var I=!!$.fn.jexcel.ignoreEvents,H=!!$.fn.jexcel.ignoreHistory;$.fn.jexcel.ignoreEvents=!0,$.fn.jexcel.ignoreHistory=!0,$.fn.jexcel.defaults[s].style&&$(this).jexcel("setStyle",$.fn.jexcel.defaults[s].style),$.fn.jexcel.defaults[s].meta&&$(this).jexcel("setMeta",$.fn.jexcel.defaults[s].meta),$.fn.jexcel.ignoreEvents=I,$.fn.jexcel.ignoreHistory=H},setData:function(e,l){var t=$(this).prop("id");e&&("string"==typeof e&&(e=JSON.parse(e)),$.fn.jexcel.defaults[t].data=e),$.fn.jexcel.defaults[t].history=[],$.fn.jexcel.defaults[t].historyIndex=-1;var n=$.fn.jexcel.defaults[t].colHeaders.length,c=$.fn.jexcel.defaults[t].data.length,o=$.fn.jexcel.defaults[t].minDimensions[0],s=$.fn.jexcel.defaults[t].minDimensions[1],r=n<o?o:n,a=c<s?s:c;for(j=0;j<a;j++)for(i=0;i<r;i++)null==$.fn.jexcel.defaults[t].data[j]&&($.fn.jexcel.defaults[t].data[j]=[]),null==$.fn.jexcel.defaults[t].data[j][i]&&($.fn.jexcel.defaults[t].data[j][i]="");$.fn.jexcel.defaults[t].formula=[],$.fn.jexcel.defaults[t].values=[];var f=$(this).find("tbody");$(f).html("");var d=[];for(j=0;j<$.fn.jexcel.defaults[t].data.length;j++){for(tr=document.createElement("tr"),$(tr).prop("id","row-"+parseInt(j)),$(tr).append('<td class="jexcel_label">'+parseInt(j+1)+"</td>"),i=0;i<$.fn.jexcel.defaults[t].colHeaders.length;i++)td=$(this).jexcel("createCell",i,j),$(tr).append(td),d.push({col:i,row:j,cell:$(td),newValue:$.fn.jexcel.defaults[t].data[j][i],oldValue:""});$(f).append(tr)}$(this).jexcel("loadCells",d,!0),$(this).jexcel("updateAllCellsWithFormulas"),e&&1!=$.fn.jexcel.ignoreEvents&&"function"==typeof $.fn.jexcel.defaults[t].onload&&$.fn.jexcel.defaults[t].onload($(this))},updateSettings:function(n){var c=$(this),o=$(this).prop("id");if(n?$.fn.jexcel.defaults[o].updateSettingsOptions=n:$.fn.jexcel.defaults[o].updateSettingsOptions&&(n=$.fn.jexcel.defaults[o].updateSettingsOptions),n){var e=$(this).find("tbody td").not(".jexcel_label");"function"==typeof n.cells?$.each(e,function(e,l){var t=$(l).prop("id").split("-");n.cells($(l),t[0],t[1])}):"function"==typeof n.table&&$.each(e,function(e,l){var t=$(l).prop("id").split("-");n.table($(c),$(l),t[0],t[1],$.fn.jexcel.defaults[o].data[t[1]][t[0]],$.fn.jexcel("getColumnNameFromId",[t[0],t[1]]))})}},openEditor:function(e,l,t){var n=$(this).prop("id"),c=$(this),o=$.fn.jexcel.defaults[n],s=$(e).prop("id").split("-");if(1==$(e).hasClass("readonly"));else if($.fn.jexcel.edition=$(e).html(),$.fn.jexcel.editionValue=$(this).jexcel("getValue",$(e)),o.columns[s[0]].editor)$(e).addClass("edition"),o.columns[s[0]].editor.openEditor(e,l,t);else if("checkbox"==o.columns[s[0]].type||"radio"==o.columns[s[0]].type||"hidden"==o.columns[s[0]].type){var r=1!=$(this).jexcel("getValue",$(e));$(this).jexcel("setValue",$(e),r)}else if("dropdown"==o.columns[s[0]].type||"autocomplete"==o.columns[s[0]].type){$(e).addClass("edition");r=$(e).find("input").val();if("function"==typeof o.columns[s[0]].filter)var a=o.columns[s[0]].filter($(this),$(e),s[0],s[1],o.columns[s[0]].source);else a=o.columns[s[0]].source;if($.fn.jdropdown){var f=document.createElement("div");$(f).jdropdown({data:a,multiple:!!o.columns[s[0]].multiple,autocomplete:!(!o.columns[s[0]].autocomplete&&"autocomplete"!=o.columns[s[0]].type),opened:!0,value:o.columns[s[0]].multiple?r.split(";"):r,onclose:function(){$(c).jexcel("closeEditor",$(e),!0)}}),$(f).css("width",$(e).width()),$(f).css("height",$(e).height())}else if("autocomplete"==o.columns[s[0]].type)console.error("This is deprected. You should include jdropdown to render the autocomplete properly");else{f=document.createElement("select");for(i=0;i<a.length;i++){"object"==typeof a[i]?(k=a[i].id,v=a[i].name):(k=a[i],v=a[i]);var d=document.createElement("option");$(d).val(k),$(d).html(v),$(f).append(d)}$(f).css("width",$(e).width()),$(f).css("height",$(e).height()),$(f).blur(function(){$(c).jexcel("closeEditor",$(this).parent(),!0)}),$(f).change(function(){$(c).jexcel("closeEditor",$(this).parent(),!0)}),$(f).focus(),r&&$(f).val(r)}$(e).html(f)}else if("calendar"==o.columns[s[0]].type){$(e).addClass("edition");r=$(e).find("input").val(),f=document.createElement("input");$(f).prop("class","editor"),$(f).css("width",$(e).width()),$(f).css("height",$(e).height()),$(f).val($(e).text()),$(e).html(f),$(f).focus(),o.columns[s[0]].options.onclose=function(){$(c).jexcel("closeEditor",$(e),!0)},$(f).jcalendar(o.columns[s[0]].options),$(f).jcalendar("open",r)}else{var u=$(e).width(),p=$(e).innerHeight();if($(e).addClass("edition"),1==o.wordWrap||1==o.columns[s[0]].wordWrap)var x=$(e).find("textarea");else x=$(e).find("input");if($(x).length)var j=$(x).val();else j=$(e).html();if(1==o.wordWrap||1==o.columns[s[0]].wordWrap)f=document.createElement("textarea");else f=document.createElement("input");$(f).prop("class","editor"),$(f).css("width",u),$(f).css("min-height",p),$(e).html(f),o.columns[s[0]].mask&&($.fn.masked?$(f).mask(o.columns[s[0]].mask,o.columns[s[0]].options):console.error("Jexcel: it was not possible to load the mask plugin.")),$(f).focus(),l||$(f).val(j),$(f).blur(function(){$(c).jexcel("closeEditor",$(this).parent(),!0)})}},closeEditor:function(e,l){$(e).removeClass("edition");var t=$(this).prop("id"),n=$.fn.jexcel.defaults[t],c=$(e).prop("id").split("-");if(1==l){if(n.columns[c[0]].editor)o=n.columns[c[0]].editor.closeEditor(e,l);else if("checkbox"==n.columns[c[0]].type||"radio"==n.columns[c[0]].type||"hidden"==n.columns[c[0]].type);else if("dropdown"==n.columns[c[0]].type||"autocomplete"==n.columns[c[0]].type)if($.fn.jdropdown)var o=$(e).find(".jdropdown").jdropdown("getValue");else if("autocomplete"==n.columns[c[0]].type)console.error("This is deprected. You should include jdropdown to render the autocomplete properly");else o=$(e).find("select").val();else if("calendar"==n.columns[c[0]].type)o=$(e).find(".jcalendar_value").val();else if("numeric"==n.columns[c[0]].type){"="!=(o=$(e).find(".editor").val()).substr(0,1)&&(o=""==o&&n.columns[c[0]].allowEmpty?"":Number(o)||0)}else o=$(e).find(".editor").val();var s=!!$.fn.jexcel.ignoreHistory;$.fn.jexcel.defaults[t].data[c[1]][c[0]]==o&&($.fn.jexcel.ignoreHistory=!0),$.fn.jexcel.defaults[t].data[c[1]][c[0]]=o,$(this).jexcel("updateCells",[{col:c[0],row:c[1],cell:$(e),newValue:o,oldValue:$.fn.jexcel.editionValue}]),$.fn.jexcel.ignoreHistory=s}else n.columns[c[0]].editor?n.columns[c[0]].editor.closeEditor(e,l):"calendar"==n.columns[c[0]].type||("dropdown"!=n.columns[c[0]].type&&"autocomplete"!=n.columns[c[0]].type||$(e).find(".jdropdown").jdropdown("close"),$(e).html($.fn.jexcel.edition),$.fn.jexcel.edition=null)},getCell:function(e){return e=$(this).jexcel("getIdFromColumnName",e),e=$(this).find("[id="+e+"]")},getValue:function(e){var l=null;if("object"!=typeof e&&(e=$(this).jexcel("getCell",e)),$(e).length){var t=$(this).prop("id"),n=$.fn.jexcel.defaults[t],c=$(e).prop("id").split("-");l=n.columns[c[0]].editor?n.columns[c[0]].editor.getValue(e):"checkbox"==n.columns[c[0]].type||"radio"==n.columns[c[0]].type?1==$(e).find("input").is(":checked")?"1":"0":"dropdown"==n.columns[c[0]].type||"autocomplete"==n.columns[c[0]].type||"calendar"==n.columns[c[0]].type?$(e).find("input").val():"currency"==n.columns[c[0]].type?$(e).html().replace(/\D/g,""):(l=$(e).find("input"),$(l).length?$(l).val():$(e).html())}return l},setValue:function(e,n,l){if("object"!=typeof e){$(this).jexcel("getIdFromColumnName",e);e=$(this).jexcel("getCell",e)}if($(e).length){var c=$(this).prop("id"),o=($(this),[]);return $.each(e,function(e,l){var t=$(l).prop("id").split("-");o.push({col:t[0],row:t[1],cell:$(l),newValue:n,oldValue:$.fn.jexcel.defaults[c].data[t[1]][t[0]]})}),l=!!l,$(this).jexcel("updateCells",o,l),!0}return!1},getText:function(e){var l=null;if("object"!=typeof e&&(e=$(this).jexcel("getCell",e)),$(e).length){var t=$(this).prop("id"),n=$.fn.jexcel.defaults[t],c=$(e).prop("id").split("-");l=n.columns[c[0]].editor?n.columns[c[0]].editor.getText(e):"checkbox"==n.columns[c[0]].type||"radio"==n.columns[c[0]].type?1==$(e).find("input").is(":checked")?"1":"0":$(e).text()}return l},loadCells:function(e,l){var t=!!$.fn.jexcel.ignoreEvents,n=!!$.fn.jexcel.ignoreHistory;$.fn.jexcel.ignoreEvents=!0,$.fn.jexcel.ignoreHistory=!0,$(this).jexcel("updateCells",e,l),$.fn.jexcel.ignoreEvents=t,$.fn.jexcel.ignoreHistory=n},updateCells:function(e,t){var l=$(this).prop("id"),n=$(this),c=$.fn.jexcel.defaults[l];$.each(e,function(e,l){l.cell=$(n).find("#"+l.col+"-"+l.row),1!=$.fn.jexcel.ignoreEvents&&"function"==typeof c.onbeforechange&&c.onbeforechange(n,$(l.cell),l.oldValue,l.newValue),t=!!t,$(n).jexcel("updateCell",l,t),1!=$.fn.jexcel.ignoreEvents&&"function"==typeof c.onchange&&c.onchange(n,$(l.cell),l.newValue,l.oldValue)}),$(this).jexcel("afterChange"),$(this).jexcel("setHistory",e)},updateCell:function(e,l){var t=$(this).prop("id"),n=$.fn.jexcel.defaults[t],c=[e.col,e.row];if($(e.cell).removeClass("error"),value=""+e.newValue,1==$(e.cell).hasClass("readonly")&&0==l);else{if(n.columns[c[0]].editor)n.columns[c[0]].editor.setValue($(e.cell),value);else if("checkbox"==n.columns[c[0]].type||"radio"==n.columns[c[0]].type)1==value||1==value||"true"==value?$(e.cell).find("input").prop("checked",!0):$(e.cell).find("input").prop("checked",!1);else if("dropdown"==n.columns[c[0]].type||"autocomplete"==n.columns[c[0]].type){if(key="",val="",value){var o=[],s=n.columns[c[0]].source;for(num=0;num<s.length;num++)"object"==typeof s[num]?o[s[num].id]=s[num].name:o[s[num]]=s[num];for(var r=value.split(";"),a=0;a<r.length;a++)o[r[a]]&&(key&&(key+=";"),key+=r[a],val&&(val+="; "),val+=o[r[a]])}val||(val="&nbsp"),$(e.cell).html('<input type="hidden" value="'+key+'">'+val+'<span class="jexcel_arrow"><span id="jexcel_arrow"></span></span>')}else"calendar"==n.columns[c[0]].type?(val="","undefined"!=value?(date=$.fn.jcalendar("fromFormatted",value,n.columns[c[0]].options.format),date&&(value=date),val=$.fn.jcalendar("label",value,n.columns[c[0]].options.format)):val="",val||(value=""),$(e.cell).html('<input type="hidden" value="'+value+'">'+val)):(val=value||"","="==value.substr(0,1)?($(this).jexcel("updateFormulas",e.col+"-"+e.row,value),$(e.cell).html('<input type="hidden" value="'+value+'">'+val)):"numeric"==n.columns[c[0]].type?$(e.cell).html('<input type="hidden" value="'+value+'">'+val):$(e.cell).html(val));$.fn.jexcel.defaults[t].data[c[1]][c[0]]=value;var i=$.fn.jexcel("getColumnName",e.col)+(parseInt(e.row)+1);value==Number(value)?$.fn.jexcel.defaults[t].values[i]=Number(value):$.fn.jexcel.defaults[t].values[i]=value,window[i]=new $.fn.jexcel.factory(i,$.fn.jexcel.defaults[t].values[i]),1!=$.fn.jexcel.ignoreEvents&&("="==value.substr(0,1)&&$(this).jexcel("executeFormula",e.col+"-"+e.row),Object.keys($.fn.jexcel.defaults[t].formula).length&&$(this).jexcel("formula",e.col+"-"+e.row))}},updateSelection:function(e,l,t){var n=$(this),c=$(this).prop("id"),o=$(this).find("tbody tr"),s=$(this).find("tbody td"),r=$(this).find(".jexcel_headers td"),a=0<$(this).find(".highlight").length,i=!1;if($(s).removeClass("highlight"),$(s).removeClass("highlight-left"),$(s).removeClass("highlight-right"),$(s).removeClass("highlight-top"),$(s).removeClass("highlight-bottom"),$(r).removeClass("selected"),$(o).removeClass("selected"),e&&l){if(or=$(e).prop("id").split("-"),de=$(l).prop("id").split("-"),parseInt(or[0])<parseInt(de[0]))var f=parseInt(or[0]),d=parseInt(de[0]);else f=parseInt(de[0]),d=parseInt(or[0]);if(parseInt(or[1])<parseInt(de[1]))var u=parseInt(or[1]),p=parseInt(de[1]);else u=parseInt(de[1]),p=parseInt(or[1]);for(var x=null,j=null,h=u,m=p,g=f;g<=d;g++){for(var v=u;v<=p;v++)$(this).find("#"+g+"-"+v).addClass("highlight"),$(this).find("#col-"+g).addClass("selected"),$(this).find("#row-"+v).addClass("selected");"hidden"!=$.fn.jexcel.defaults[c].columns[g].type&&(null==x&&(x=g),j=g)}for(g=x;g<=j;g++)$(this).find("#"+g+"-"+h).addClass("highlight-top"),$(this).find("#"+g+"-"+m).addClass("highlight-bottom");for(v=h;v<=m;v++)$(this).find("#"+x+"-"+v).addClass("highlight-left"),$(this).find("#"+j+"-"+v).addClass("highlight-right");i=!0}1!=$.fn.jexcel.ignoreEvents&&($.fn.jexcel.defaults[c].onblur&&"function"==typeof $.fn.jexcel.defaults[c].onblur&&1==a&&0==i&&$.fn.jexcel.defaults[c].onblur($(this)),$.fn.jexcel.defaults[c].onfocus&&"function"==typeof $.fn.jexcel.defaults[c].onfocus&&0==a&&1==i&&$.fn.jexcel.defaults[c].onfocus($(this)),1==i&&$.fn.jexcel.defaults[c].onselection&&"function"==typeof $.fn.jexcel.defaults[c].onselection&&$.fn.jexcel.defaults[c].onselection($(this),e,l,t)),$.fn.jexcel.selection=e&&l?[e,l]:null,setTimeout(function(){$(n).jexcel("updateCornerPosition")},0)},resetSelection:function(){$.fn.jexcel.current&&$("#"+$.fn.jexcel.current).jexcel("updateSelection"),$(".jexcel_corner").css("left","-200px"),$.fn.jexcel.selectedRow=null,$.fn.jexcel.selectedCell=null,$.fn.jexcel.selectedHeader=null},getSelection:function(){if($.fn.jexcel.current)return $.fn.jexcel.selection},getCellCursor:function(){if($.fn.jexcel.current)return $.fn.jexcel.selectedCell},getSelectedCells:function(){if($.fn.jexcel.current)return $("#"+$.fn.jexcel.current).find("tbody td.highlight")},updateCornerSelection:function(e){$(this);var l=$(this).find("tbody td");$(l).removeClass("selection"),$(l).removeClass("selection-left"),$(l).removeClass("selection-right"),$(l).removeClass("selection-top"),$(l).removeClass("selection-bottom");var t=$(this).find("tbody td.highlight"),n=$(t[0]).prop("id").split("-"),c=$(t[t.length-1]).prop("id").split("-"),o=$(e).prop("id").split("-");if(o[1]>c[1]||o[1]<n[1]){var s=parseInt(n[0]),r=parseInt(c[0]);if(parseInt(o[1])>parseInt(c[1]))var a=parseInt(c[1])+1,f=parseInt(o[1]);else a=parseInt(o[1]),f=parseInt(n[1])-1}else if(o[0]>c[0]||o[0]<n[0]){a=parseInt(n[1]),f=parseInt(c[1]);if(parseInt(o[0])>parseInt(c[0]))s=parseInt(c[0])+1,r=parseInt(o[0]);else s=parseInt(o[0]),r=parseInt(n[0])-1}for(j=a;j<=f;j++)for(i=s;i<=r;i++)$(this).find("#"+i+"-"+j).addClass("selection"),$(this).find("#"+i+"-"+a).addClass("selection-top"),$(this).find("#"+i+"-"+f).addClass("selection-bottom"),$(this).find("#"+s+"-"+j).addClass("selection-left"),$(this).find("#"+r+"-"+j).addClass("selection-right")},updateCornerPosition:function(){var e=$(this).find(".highlight");if($(e).length){var l=$(e).last(),t=parseInt($(l).offset().top)+$(l).parent().innerHeight()-3,n=parseInt($(l).offset().left)+$(l).innerWidth()-2;$(".jexcel_corner").css("top",t),$(".jexcel_corner").css("left",n);var c=$(this).offset().top;t<=c+$(this).height()&&c<=t||($(".jexcel_corner").css("top",-200),$(".jexcel_corner").css("left",-200));var o=$(this).offset().left;n<=o+$(this).width()-5&&o<=n||($(".jexcel_corner").css("top",-200),$(".jexcel_corner").css("left",-200))}},getData:function(e){var l=[],t=0,n=0,c=$(this).prop("id"),o=$.fn.jexcel.defaults[c].columns.length,s=$.fn.jexcel.defaults[c].data.length;for(j=0;j<s;j++){for(i=t=0;i<o;i++)cell=$(this).find("#"+i+"-"+j),e&&!$(cell).hasClass("highlight")||(l[n]||(l[n]=[]),l[n][t]=$(this).jexcel("getValue",$(cell)),t++);0<t&&n++}return l},getRowData:function(e){var t=$(this),n=[];if(parseInt(e)){if(-1==e){var l=$(this).prop("id");e=$.fn.jexcel.defaults[l].data.length-1}}else e=0;var c=$(this).find(".jexcel-content .r"+e);return $.each(c,function(e,l){n.push($(t).jexcel("getValue",$(l)))}),n},getColumnData:function(e){var t=$(this),n=[];if(parseInt(e)){if(-1==e){var l=$(this).prop("id");e=$.fn.jexcel.defaults[l].columns.length-1}}else e=0;var c=$(this).find(".jexcel-content .c"+e);return $.each(c,function(e,l){n.push($(t).jexcel("getValue",$(l)))}),n},copy:function(e,l,t){var n=$(this).prop("id");l||(l="\t");for(var c=[],o=[],s=$.fn.jexcel.defaults[n].data[0].length,r=$.fn.jexcel.defaults[n].data.length,a="",i=[],f=0;f<r;f++){c=[];for(var d=0;d<s;d++)cell=$(this).find("#"+d+"-"+f),e&&!$(cell).hasClass("highlight")||(val=$(this).jexcel("getValue",$(cell)),val.match&&(val.match(/,/g)||val.match(/\n/)||val.match(/\"/))&&(val=val.replace(new RegExp('"',"g"),'""'),val='"'+val+'"'),c.push(val),a=$(cell).attr("style"),i.push(a||""));c.length&&o.push(c.join(l))}var u=o.join("\n");return t||(txt=$(".jexcel_textarea"),$(txt).val(u),$(txt).select(),document.execCommand("copy")),$.fn.jexcel.hash=$(this).jexcel("hash",u),$.fn.jexcel.style=i,u},cut:function(){var e=$(this).find(".highlight");if(0<$(e).length){var n=[];$.each(e,function(e,l){var t=$(l).prop("id").split("-");n.push({col:t[0],row:t[1],cell:$(l),newValue:"",oldValue:$.fn.jexcel.defaults[$.fn.jexcel.current].data[t[1]][t[0]]})}),$(this).jexcel("copy",!0),$(this).jexcel("updateCells",n)}},paste:function(e,l){var t=$(this).prop("id");"function"==typeof $.fn.jexcel.defaults[t].onbeforepaste&&(l=$.fn.jexcel.defaults[t].onbeforepaste(l));var n=$(this).jexcel("hash",l)==$.fn.jexcel.hash?$.fn.jexcel.style:null;l=$(this).jexcel("parseCSV",l,"\t");var c=$(e).prop("id");if(c){c=c.split("-");var o=parseInt(c[0]),s=parseInt(c[1]);s+l.length>$.fn.jexcel.defaults[t].data.length&&$(this).jexcel("insertRow",s+l.length-$.fn.jexcel.defaults[t].data.length),l[0]&&(row=l[0],o+row.length>$.fn.jexcel.defaults[t].data[s].length&&$(this).jexcel("insertColumn",o+row.length-$.fn.jexcel.defaults[t].data[s].length));var r=[],a=0;for(j=0;j<l.length;j++)for(row=l[j],i=0;i<row.length;i++)e=$(this).find("#"+(parseInt(i)+parseInt(o))+"-"+(parseInt(j)+parseInt(s))),0<$(e).length&&r.push({col:parseInt(i)+parseInt(o),row:parseInt(j)+parseInt(s),cell:$(e),newValue:row[i],oldValue:$.fn.jexcel.defaults[t].data[parseInt(j)+parseInt(s)][parseInt(i)+parseInt(o)]}),n&&$(e).attr("style",n[a]),a++;$(this).jexcel("updateSelection",r[0].cell,r[r.length-1].cell),0<r.length&&($(this).jexcel("updateCells",r),"function"==typeof $.fn.jexcel.defaults[t].onpaste&&(l=$.fn.jexcel.defaults[t].onpaste(r)))}},parseCSV:function(e,l){9==(e=e.replace(/\r?\n$|\r$|\n$/g,"")).charCodeAt(e.length-1)&&(e+="\0"),l=l||",";for(var t=[],n=!1,c=0,o=0,s=0;s<e.length;s++){var r=e[s],a=e[s+1];t[c]=t[c]||[],t[c][o]=t[c][o]||"",'"'==r&&n&&'"'==a?(t[c][o]+=r,++s):'"'!=r?r!=l||n?"\r"!=r||"\n"!=a||n?("\n"!=r||n)&&("\r"!=r||n)?t[c][o]+=r:(++c,o=0):(++c,o=0,++s):++o:n=!n}return t},insertColumn:function(e,l,t){var n=$(this).prop("id"),c=$.fn.jexcel.defaults[n];if(1==c.allowInsertColumn){var o=[],s=[];0<e?numOfColumns=e:(numOfColumns=1,e&&(s=e));var r=c.colHeaders.length,a=0;if(null==t||t>=parseInt(r)){t=parseInt(r);a=1}l||(l=[]),l.columns||(l.columns=[]),l.colWidths||(l.colWidths=[]),l.colHeaders||(l.colHeaders=[]),l.colAlignments||(l.colAlignments=[]),l.colHeaderClasses||(l.colHeaderClasses=[]);for(var i=0;i<numOfColumns;i++)l.columns[i]||(l.columns[i]={type:"text"}),l.colWidths[i]||(l.colWidths[i]=50),l.colHeaders[i]||(l.colHeaders[i]=""),l.colAlignments[i]||(l.colAlignments[i]="center"),l.colHeaderClasses[i]||(l.colHeaderClasses[i]="");var f=c.columns.splice(t),d=c.colWidths.splice(t),u=c.colHeaders.splice(t),p=c.colAlignments.splice(t),x=c.colHeaderClasses.splice(t);i=0;for(var j=t;j<numOfColumns+t;j++)c.columns[j]=l.columns[i],c.colWidths[j]=l.colWidths[i],c.colHeaders[j]=l.colHeaders[i],c.colAlignments[j]=l.colAlignments[i],c.colHeaderClasses[j]=l.colHeaderClasses[i],c.columns[j].source||($.fn.jexcel.defaults[n].columns[j].source=[]),c.columns[j].options||($.fn.jexcel.defaults[n].columns[j].options=[]),i++;if(Array.prototype.push.apply(c.columns,f),Array.prototype.push.apply(c.colWidths,d),Array.prototype.push.apply(c.colHeaders,u),Array.prototype.push.apply(c.colAlignments,p),Array.prototype.push.apply(c.colHeaderClasses,x),1==a){var h=$(this).find(".jexcel-header #col-"+(t-1)),m=$(this).find(".jexcel-header > table > colgroup > col").eq(t),g=$(this).find(".jexcel-content > table > colgroup > col").eq(t);for(j=numOfColumns+t-1;t<=j;j--){$(m).after('<col width="'+c.colWidths[j]+'">'),$(g).after('<col width="'+c.colWidths[j]+'">');var v=(I=c.colHeaders[j])||$.fn.jexcel("getColumnName",j),C="hidden"==c.columns[j].type?' style="display:none"':"";td='<td align="'+c.colAlignments[j]+'" title="'+I+'" class="'+c.colHeaderClasses[j]+'"'+C+">"+v+"</td>",$(h).after(td)}for(var y=0;y<c.data.length;y++){var w=$.fn.jexcel.defaults[n].data[y].splice(t),b=$(this).find("tbody").find("#row-"+y).find(".c"+(t-1));for(j=numOfColumns+t-1;t<=j;j--)td=$(this).jexcel("createCell",j,y),$(b).after(td),$.fn.jexcel.defaults[n].data[y][j]=s[y]?s[y]:"",o.push({col:j,row:y,cell:$(td),newValue:$.fn.jexcel.defaults[n].data[y][j],oldValue:""});Array.prototype.push.apply($.fn.jexcel.defaults[n].data[y],w)}}else{for(h=$(this).find(".jexcel-header #col-"+t),m=$(this).find(".jexcel-header > table > colgroup > col").eq(t+1),g=$(this).find(".jexcel-content > table > colgroup > col").eq(t+1),j=t;j<numOfColumns+t;j++){$(m).before('<col width="'+c.colWidths[j]+'">'),$(g).before('<col width="'+c.colWidths[j]+'">');var I;v=(I=c.colHeaders[j])||$.fn.jexcel("getColumnName",j),C="hidden"==c.columns[j].type?' style="display:none"':"";td='<td align="'+c.colAlignments[j]+'" title="'+I+'" class="'+c.colHeaderClasses[j]+'"'+C+">"+v+"</td>",$(h).before(td)}for(y=0;y<c.data.length;y++){for(w=$.fn.jexcel.defaults[n].data[y].splice(t),b=$(this).find("tbody").find("#row-"+y).find(".c"+t),j=t;j<numOfColumns+t;j++)td=$(this).jexcel("createCell",j,y),$(b).before(td),$.fn.jexcel.defaults[n].data[y][j]=s[y]?s[y]:"",o.push({col:j,row:y,cell:$(td),newValue:$.fn.jexcel.defaults[n].data[y][j],oldValue:""});Array.prototype.push.apply($.fn.jexcel.defaults[n].data[y],w)}}$(this).jexcel("updateTableReferences",t,0),$(this).jexcel("updateSelection",o[0].cell,o[o.length-1].cell),$(this).jexcel("loadCells",o,!0),$(this).jexcel("setHistory",o,{type:"insertColumn",mixed:e,properties:l,columnNumber:t}),1!=$.fn.jexcel.ignoreEvents&&"function"==typeof c.oninsertcolumn&&c.oninsertcolumn($(this))}},insertRow:function(e,l){var t=$(this),n=$(this).prop("id"),c=$.fn.jexcel.defaults[n];if(1==c.allowInsertRow){var o=[],s=[];if(0<e)var r=e;else{r=1;e&&(s=e)}var a=c.data.length,i=0;if(null==l||l>=parseInt(a)){l=parseInt(a);i=1}var f=$.fn.jexcel.defaults[n].data.splice(l);if(1==i)var d=$(this).find("tbody").find("#row-"+(l-1));else d=$(this).find("tbody").find("#row-"+l);function u(){var e=document.createElement("tr");$(e).append('<td class="jexcel_label"></td>'),$.fn.jexcel.defaults[n].data[p]=[];for(var l=0;l<$.fn.jexcel.defaults[n].colHeaders.length;l++)$.fn.jexcel.defaults[n].data[p][l]=s[l]?s[l]:"",td=$(t).jexcel("createCell",l,p),$(e).append(td),o.push({col:l,row:p,cell:$(td),newValue:$.fn.jexcel.defaults[n].data[p][l],oldValue:""});return e}if(1==i)for(var p=r+l-1;l<=p;p--)$(d).after(u());else for(p=l;p<r+l;p++)$(d).before(u());Array.prototype.push.apply($.fn.jexcel.defaults[n].data,f),$(this).jexcel("updateTableReferences"),$(this).jexcel("updateSelection",o[0].cell,o[o.length-1].cell),$(this).jexcel("loadCells",o,!0),$(this).jexcel("setHistory",o,{type:"insertRow",mixed:e,rowNumber:l}),1!=$.fn.jexcel.ignoreEvents&&"function"==typeof c.oninsertrow&&c.oninsertrow($(this))}},deleteColumn:function(e,l){var t=$(this).prop("id"),n=$.fn.jexcel.defaults[t];if(1==n.allowDeleteColumn){var c=[];if(null==e){var o=$(this).jexcel("getSelectedColumns");l=o[0]?(e=parseInt(o[0]),parseInt(o.length)):(e=$.fn.jexcel.defaults[t].data[0].length-1,1)}if(-1==e&&(e=$.fn.jexcel.defaults[t].data[0].length-1),l!=parseInt(l)&&(l=1),l>n.data[0].length-e&&(l=n.data[0].length-e),1<n.data[0].length){if(-1<parseInt(e)){for(var s=n.columns.splice(e,l),r=n.colHeaders.splice(e,l),a=n.colWidths.splice(e,l),i=n.colAlignments.splice(e,l),f=n.colHeaderClasses.splice(e,l),d=0;d<$.fn.jexcel.defaults[t].data.length;d++){data=n.data[d].splice(e,l);for(var u=0;u<l;u++)c[u]||(c[u]=[]),c[u].push(data[u])}var p=!1;for(u=e;u<e+l;u++){var x=$(this).find("thead #col-"+u);$(x).hasClass("selected")&&(p=!0),$(x).remove(),$(this).find("tbody .c"+u).remove()}if($(this).jexcel("updateTableReferences",e,0),p){var j=$(this).find("#0-0"),h=$(this).find("#0-0");$(this).jexcel("updateSelection",j,h)}}$(this).jexcel("setHistory",null,{type:"deleteColumn",columnNumber:e,numOfColumns:l,columnData:c,columnProperties:{columns:s,colHeaders:r,colWidths:a,colAlignments:i,colHeaderClasses:f}}),1!=$.fn.jexcel.ignoreEvents&&"function"==typeof n.ondeletecolumn&&n.ondeletecolumn($(this),e,l,c)}else console.error("It is not possible to delete the last column")}},deleteRow:function(e,l){var t=$(this).prop("id"),n=$.fn.jexcel.defaults[t];if(1==n.allowDeleteRow){var c=[];if(null==e){var o=$(this).jexcel("getSelectedRows");l=o[0]?(e=parseInt(o[0]),parseInt(o.length)):(e=$.fn.jexcel.defaults[t].data.length-1,1),e=parseInt(o[0]),l=parseInt(o.length)}if(-1==e&&(e=$.fn.jexcel.defaults[t].data.length-1),l!=parseInt(l)&&(l=1),l>n.data.length-e&&(l=n.data.length-l),1<n.data.length){if(-1<parseInt(e)){for(var s=!1,r=e;r<e+l;r++){c[r]=$.fn.jexcel.defaults[t].data[r];var a=$(this).find("#row-"+r);$(a).hasClass("selected")&&(s=!0),$(a).remove()}if($.fn.jexcel.defaults[t].data.splice(parseInt(e),l),$(this).jexcel("updateTableReferences",0,e),s){var i=$(this).find("#0-0"),f=$(this).find("#0-0");$(this).jexcel("updateSelection",i,f)}$(this).jexcel("setHistory",null,{type:"deleteRow",rowNumber:e,numOfRows:l,rowData:c}),1!=$.fn.jexcel.ignoreEvents&&"function"==typeof n.ondeleterow&&n.ondeleterow($(this),e,l,c)}}else console.error("It is not possible to delete the last row")}},setWidth:function(e,l){var t=$(this).prop("id");if(0<l){"object"==typeof e&&(e=(e=$(e).prop("id").split("-"))[0]);var n=$(this).find(".jexcel-header col");$(n[parseInt(e)+1]).prop("width",l);n=$(this).find(".jexcel-content col");var c=$(n[parseInt(e)+1]).prop("width");$(n[parseInt(e)+1]).prop("width",l),$.fn.jexcel.defaults[t].colWidths[e]=l,$(this).jexcel("setHistory",null,{type:"setWidth",column:e,fr:c,to:l})}},getWidth:function(e){var l=$(this).prop("id");return e?("object"==typeof e&&(e=(e=$(e).prop("id").split("-"))[0]),$.fn.jexcel.defaults[l].colWidths[e]):$.fn.jexcel.defaults[l].colWidths},getHeader:function(e){var l=$(this).find(".jexcel_headers #col-"+e);if(l.length)return $(l).html()},getHeaders:function(e){var l=$(this).find(".jexcel_headers > td"),t=[];return $.each(l,function(e,l){0<e&&t.push($(l).text())}),1==e&&(t=t.join(",")),t},setHeader:function(e,l){var t=$(this).find("thead #col-"+e);if(t.length){l||(l=prompt("Column name",$(t).text()));var n=$(t).html();n=n.replace($(t).text(),l),$(t).html(n)}},setSource:function(e,l){"object"==typeof e&&(e=(e=$(e).prop("id").split("-"))[0]);var t=$(this).prop("id");$.fn.jexcel.defaults[t].columns[e].source=l},afterChange:function(e){var l=$(this).prop("id");e||$(this).jexcel("spareCheck"),$(this).jexcel("updateCornerPosition"),$(this).jexcel("updateSettings"),1!=$.fn.jexcel.ignoreEvents&&"function"==typeof $.fn.jexcel.defaults[l].onafterchange&&$.fn.jexcel.defaults[l].onafterchange($(this))},copyData:function(e,l){var t=$(this).jexcel("getData",!0),n=parseInt(e[0]),c=parseInt(l[0]),o=parseInt(e[1]),s=parseInt(l[1]),r=[],a=0,f=0;for(j=o;j<=s;j++){for(null==t[f]&&(f=0),a=0,i=n;i<=c;i++)null==t[f]?a=0:null==t[f][a]&&(a=0),cell=$(this).find("#"+i+"-"+j),$(cell).length&&!$(cell).hasClass("readonly")&&r.push({col:i,row:j,cell:$(cell),newValue:t[f][a],oldValue:$.fn.jexcel.defaults[$.fn.jexcel.current].data[j][i]}),a++;f++}0<r.length&&$(this).jexcel("updateCells",r)},orderBy:function(e,l){if(0<=e){var t=$(this).find("#col-"+e).parent();if("0"!=l&&"1"!=l){var n=$(t).find(".arrow-down");l=0<$(n).length?1:0}$(t).find(".arrow-down").remove(),$(t).find(".arrow-up").remove(),$(t).find("td").css("text-decoration","none"),1==l?$(t).find("#col-"+e).append('<span class="arrow-up"></span>').css("text-decoration","underline"):$(t).find("#col-"+e).append('<span class="arrow-down"></span>').css("text-decoration","underline"),$(".jexcel_corner").css("top","-200px"),$(".jexcel_corner").css("left","-200px");var c=$(this).prop("id"),o=$.fn.jexcel.defaults[c];return Array.prototype.sortBy=function(c,o){return this.slice(0).sort(function(e,l){if(Number(e[c])==e[c]&&Number(l[c])==l[c])var t=Number(e[c]),n=Number(l[c]);else t=e[c].toLowerCase(),n=l[c].toLowerCase();return o?n<t?-1:t<n?1:0:n<t?1:t<n?-1:0})},o.data=o.data.sortBy(e,l),$(this).jexcel("setData",null,!0),1!=$.fn.jexcel.ignoreEvents&&"function"==typeof $.fn.jexcel.defaults[c].onsort&&$.fn.jexcel.defaults[c].onsort($(this),e,l),!0}},updateFormulas:function(t,e){if("object"==typeof excelFormulaUtilities){var n=$(this).prop("id"),l=excelFormulaUtilities.formula2JavaScript(e).match(/([A-Z]+[0-9]+)*/g);$.each(l,function(e,l){l&&(elementId=$.fn.jexcel("getIdFromColumnName",l),$.fn.jexcel.defaults[n].formula[elementId]||($.fn.jexcel.defaults[n].formula[elementId]=[]),elementId==t?console.error("Self reference error: "+l):$.fn.jexcel.defaults[n].formula[elementId].push(t))})}},formula:function(n){if("object"==typeof excelFormulaUtilities){var c=$(this).prop("id"),o=$(this);$.fn.jexcel.defaults[c].formula[n]&&$.each($.fn.jexcel.defaults[c].formula[n],function(e,l){var t=l.split("-");"="!=$.fn.jexcel.defaults[c].data[t[1]][t[0]].substr(0,1)?($(o).find("#"+l).removeClass("error"),$.fn.jexcel.defaults[c].formula[n].splice(e,1)):$(o).jexcel("executeFormula",l),$(o).jexcel("formula",l)})}else console.error("excelFormulaUtilities lib not included")},executeFormula:function(cellId){if("object"==typeof excelFormulaUtilities){var id=$(this).prop("id"),cell=$(this).find("#"+cellId),cellId=cellId.split("-"),formula=$.fn.jexcel.defaults[id].data[cellId[1]][cellId[0]];try{var value=eval(excelFormulaUtilities.formula2JavaScript(formula))}catch(e){var value=null}if(null===value||null==value||""+value=="NaN"||"function"==typeof value)value='<input type="hidden" value="'+formula+'">#ERROR',$(cell).addClass("error"),$(cell).html(value);else{var letter=$.fn.jexcel("getColumnName",cellId[0])+(parseInt(cellId[1])+1);value==Number(value)?$.fn.jexcel.defaults[id].values[letter]=Number(value):$.fn.jexcel.defaults[id].values[letter]=value,window[letter]=new $.fn.jexcel.factory(letter,$.fn.jexcel.defaults[id].values[letter]),value='<input type="hidden" value="'+formula+'">'+value,$(cell).removeClass("error"),$(cell).html(value)}}},updateAllCellsWithFormulas:function(){if("object"==typeof excelFormulaUtilities){var e=$(this).prop("id"),l=Object.keys($.fn.jexcel.defaults[e].formula);if(0<l.length)for(var t=0;t<l.length;t++)$(this).jexcel("formula",l[t])}},helper:function(e){var l=[];if("object"==typeof e&&"createEmptyData"==e.action){var t=e.cols||10,n=e.rows||100;for(j=0;j<n;j++)for(l[j]=[],i=0;i<t;i++)l[j][i]=""}return l},download:function(){var e=$(this).prop("id"),l=$.fn.jexcel.defaults[e],t="";1==l.csvHeaders&&(t=$(this).jexcel("getHeaders",!0)+"\n"),t+=$(this).jexcel("copy",!1,",",!0);var n=new Blob(["\ufeff"+t],{type:"text/csv;charset=utf-8;"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(n,l.csvFileName+".csv");else{var c=document.createElement("a"),o=URL.createObjectURL(n);c.href=o,c.setAttribute("download",l.csvFileName+".csv"),document.body.appendChild(c),c.click(),document.body.removeChild(c)}},setHistory:function(e,l){if(1!=$.fn.jexcel.ignoreHistory){$(this);var t=$(this).prop("id"),n=++$.fn.jexcel.defaults[t].historyIndex,c=$.fn.jexcel.defaults[t].history=$.fn.jexcel.defaults[t].history.slice(0,1+n);c[n]=l?{action:l}:{firstSelected:e[0].cell,lastSelected:e[e.length-1].cell,cellChanges:e}}},undo:function(){var e=$(this).prop("id"),l=!!$.fn.jexcel.ignoreEvents,t=!!$.fn.jexcel.ignoreHistory;$.fn.jexcel.ignoreEvents=!0,$.fn.jexcel.ignoreHistory=!0;var n=[];if(0<=$.fn.jexcel.defaults[e].historyIndex){var c=$.fn.jexcel.defaults[e].history[$.fn.jexcel.defaults[e].historyIndex--];if(c.action)if("insertRow"==c.action.type){var o=c.action.rowNumber,s=0<c.action.mixed?c.action.mixed:1;$(this).jexcel("deleteRow",o,s)}else if("deleteRow"==c.action.type){o=c.action.rowNumber,s=c.action.numOfRows;for(var r=o;r<o+s;r++)$(this).jexcel("insertRow",c.action.rowData[r],r)}else if("insertColumn"==c.action.type){var a=c.action.columnNumber,i=0<c.action.mixed?c.action.mixed:1;$(this).jexcel("deleteColumn",a,i)}else if("deleteColumn"==c.action.type){a=c.action.columnNumber,i=c.action.numOfColumns;for(var f=c.action.columnProperties,d=0,u=a;u<a+i;u++)$(this).jexcel("insertColumn",c.action.columnData[d],{columns:[f.columns[d]],colHeaders:[f.colHeaders[d]],colWidths:[f.colWidths[d]],colAlignments:[f.colAlignments[d]],colHeaderClasses:[f.colHeaderClasses[d]]},u),d++}else"moveRow"==c.action.type?$(this).jexcel("moveRow",c.action.to,c.action.fr):"setStyle"==c.action.type?$(this).jexcel("setStyle",c.action.fr):"setWidth"==c.action.type&&$(this).jexcel("setWidth",c.action.column,c.action.fr);else{for(var p=0;p<c.cellChanges.length;p++)n.push({col:c.cellChanges[p].col,row:c.cellChanges[p].row,cell:c.cellChanges[p].cell,newValue:c.cellChanges[p].oldValue,oldValue:c.cellChanges[p].newValue});$.fn.jexcel.selectedCell=c.firstSelected,$(this).jexcel("updateSelection",c.firstSelected,c.lastSelected),$(this).jexcel("loadCells",n)}}$.fn.jexcel.ignoreEvents=l,$.fn.jexcel.ignoreHistory=t,$(this).jexcel("updateAllCellsWithFormulas"),$(this).jexcel("afterChange")},redo:function(){var e=$(this).prop("id"),l=!!$.fn.jexcel.ignoreEvents,t=!!$.fn.jexcel.ignoreHistory;if($.fn.jexcel.ignoreEvents=!0,$.fn.jexcel.ignoreHistory=!0,$.fn.jexcel.defaults[e].historyIndex<$.fn.jexcel.defaults[e].history.length-1){var n=$.fn.jexcel.defaults[e].history[++$.fn.jexcel.defaults[e].historyIndex];n.action?"insertRow"==n.action.type?$(this).jexcel("insertRow",n.action.mixed,n.action.rowNumber):"deleteRow"==n.action.type?$(this).jexcel("deleteRow",n.action.rowNumber,n.action.numOfRows):"insertColumn"==n.action.type?$(this).jexcel("insertColumn",n.action.mixed,n.action.properties,n.action.columnNumber):"deleteColumn"==n.action.type?$(this).jexcel("deleteColumn",n.action.columnNumber,n.action.numOfColumns):"moveRow"==n.action.type?$(this).jexcel("moveRow",n.action.fr,n.action.to):"setStyle"==n.action.type?$(this).jexcel("setStyle",n.action.to):"setWidth"==n.action.type&&$(this).jexcel("setWidth",n.action.column,n.action.to):($.fn.jexcel.selectedCell=n.firstSelected,$(this).jexcel("updateSelection",n.firstSelected,n.lastSelected),$(this).jexcel("loadCells",n.cellChanges))}$.fn.jexcel.ignoreEvents=l,$.fn.jexcel.ignoreHistory=t,$(this).jexcel("updateAllCellsWithFormulas"),$(this).jexcel("afterChange")},createCell:function(e,l){var t=$(this).prop("id"),n=$.fn.jexcel.defaults[t];return align=n.colAlignments[e],width=n.colWidths[e],td=document.createElement("td"),$(td).prop("width",width),$(td).prop("align",align),$(td).prop("id",e+"-"+l),$(td).addClass("c"+e),$(td).addClass("r"+l),"hidden"==n.columns[e].type?$(td).css("display","none"):"checkbox"==n.columns[e].type?1==n.columns[e].readOnly?$(td).html('<input type="checkbox" disabled="disabled">'):$(td).html('<input type="checkbox">'):"radio"==n.columns[e].type&&(1==n.columns[e].readOnly?$(td).html('<input type="radio" name="c'+e+'" disabled="disabled">'):$(td).html('<input type="radio" name="c'+e+'">')),1==n.columns[e].readOnly&&$(td).addClass("readonly","readonly"),1!=n.wordWrap&&1!=n.columns[e].wordWrap||$(td).css("white-space","pre-wrap"),n.columns[e].cssClass&&$(td).addClass(n.columns[e].cssClass),$(td)},spareCheck:function(){var e=$(this).prop("id"),l=!1,t=!!$.fn.jexcel.ignoreEvents,n=!!$.fn.jexcel.ignoreHistory;if($.fn.jexcel.ignoreEvents=!0,$.fn.jexcel.ignoreHistory=!0,0<$.fn.jexcel.defaults[e].minSpareCols){lastCol=$.fn.jexcel.defaults[e].data[0]?$.fn.jexcel.defaults[e].data[0].length:0,lastRow=$.fn.jexcel.defaults[e].data.length,checkPoint=lastCol-$.fn.jexcel.defaults[e].minSpareCols,checkPoint<0&&(checkPoint=0),l=!1;for(var c=0;c<lastRow;c++)for(var o=checkPoint;o<lastCol;o++)$.fn.jexcel.defaults[e].data[c][o]&&(l=!0);l&&$(this).jexcel("insertColumn",$.fn.jexcel.defaults[e].minSpareCols)}if(0<$.fn.jexcel.defaults[e].minSpareRows){lastCol=$.fn.jexcel.defaults[e].data[0]?$.fn.jexcel.defaults[e].data[0].length:0,lastRow=$.fn.jexcel.defaults[e].data.length,checkPoint=lastRow-$.fn.jexcel.defaults[e].minSpareRows,checkPoint<0&&(checkPoint=0),l=!1;for(c=checkPoint;c<lastRow;c++)for(o=0;o<lastCol;o++)$.fn.jexcel.defaults[e].data[c][o]&&(l=!0);l&&$(this).jexcel("insertRow",$.fn.jexcel.defaults[e].minSpareCols)}$.fn.jexcel.ignoreEvents=t,$.fn.jexcel.ignoreHistory=n},getSelectedRows:function(){var t=[],e=$(this).find("tbody > tr.selected");return $.each(e,function(e,l){t.push($(l).prop("id").replace("row-",""))}),t},getSelectedColumns:function(){var t=[],e=$(this).find(".jexcel_headers > td.selected");return $.each(e,function(e,l){t.push($(l).prop("id").replace("col-",""))}),t},getHeaderNumber:function(e){var l=!1;if(e){var t=$(this).find(".jexcel_headers > td."+e);$(t).length&&(l=parseInt($(t).prop("id").replace("col-","")))}return l},updateTableReferences:function(s,t){var e=$(this),r=$(this).prop("id");if(s||(s=0),t||(t=0),-1<s){var l=$(this).find(".jexcel_headers td");$.each(l,function(e,l){if(0<e&&s<=e&&($(l).prop("id","col-"+(e-1)),!$(l).prop("title"))){var t=$.fn.jexcel("getColumnName",e-1);$(l).html(t)}})}var n=$(this).find(".jexcel-content tbody > tr");$.each(n,function(o,e){if(t<=o){$(e).prop("id","row-"+o);var l=$(e).find("td");$.each(l,function(e,l){if(0==e)$(l).html(parseInt(o)+1);else if(s<=e){var t=$(l).prop("id").split("-");$(l).prop("id",e-1+"-"+o),$(l).removeClass("r"+t[1]),$(l).addClass("r"+o),$(l).removeClass("c"+t[0]),$(l).addClass("c"+(e-1));var n=""+$.fn.jexcel.defaults[r].data[o][e-1];"="==n.substr(0,1)&&(t[0]!=e-1&&(n=$.fn.jexcel("shiftFormulaByColumn",n,e-1-t[0]),$.fn.jexcel.defaults[r].data[o][e-1]=n,$(l).find("input").val(n)),t[1]!=o&&(n=$.fn.jexcel("shiftFormulaByRow",n,o-t[1]),$.fn.jexcel.defaults[r].data[o][e-1]=n,$(l).find("input").val(n)));var c=$.fn.jexcel("getColumnNameFromId",[e-1,o]);n==Number(n)?$.fn.jexcel.defaults[r].values[c]=Number(n):$.fn.jexcel.defaults[r].values[c]=n,window[c]=new $.fn.jexcel.factory(c,$.fn.jexcel.defaults[r].values[c])}})}}),$.fn.jexcel.defaults[r].formula=[];for(var c=0;c<$.fn.jexcel.defaults[r].data.length;c++)for(var o=0;o<$.fn.jexcel.defaults[r].data[c].length;o++){var a=""+$.fn.jexcel.defaults[r].data[c][o];"="==a.substr(0,1)&&$(e).jexcel("updateFormulas",o+"-"+c,a)}$(this).jexcel("updateAllCellsWithFormulas"),$(this).jexcel("afterChange")},moveRow:function(e,l){var t=$(this).prop("id");$.fn.jexcel.defaults[t].data.splice(l,0,$.fn.jexcel.defaults[t].data.splice(e,1)[0]);var n=$(this).find("#row-"+e).clone();$(this).find("#row-"+e).remove(),l<e?$(this).find("#row-"+l).before(n):$(this).find("#row-"+l).after(n),$(this).jexcel("updateTableReferences",0,0),"function"==typeof $.fn.jexcel.defaults[t].onmoverow&&$.fn.jexcel.defaults[t].onmoverow($(this),e,l),$(this).jexcel("setHistory",null,{type:"moveRow",fr:e,to:l})},moveColumn:function(){},getColumnName:function(e){var l="";return 701<e?(l+=String.fromCharCode(64+parseInt(e/676)),l+=String.fromCharCode(64+parseInt(e%676/26))):25<e&&(l+=String.fromCharCode(64+parseInt(e/26))),l+=String.fromCharCode(65+e%26)},getIdFromColumnName:function(e,l){var t=/^[a-zA-Z]+/.exec(e);if(t){for(var n=0,c=0;c<t[0].length;c++)n+=parseInt(t[0].charCodeAt(c)-64)*Math.pow(26,t[0].length-1-c);--n<0&&(n=0);var o=parseInt(/[0-9]+$/.exec(e));0<o&&o--,e=1==l?[n,o]:n+"-"+o}return e},getColumnNameFromId:function(e){return Array.isArray(e)||(e=e.split("-")),$.fn.jexcel("getColumnName",e[0])+(parseInt(e[1])+1)},shiftFormulaByColumn:function(e,t){t||(t=1);for(var l=excelFormulaUtilities.formula2JavaScript(e).match(/([A-Z]+[0-9]+)*/g).filter(function(e){return""!=e}).sort(function(e,l){return e=$.fn.jexcel("getIdFromColumnName",e,!0),l=$.fn.jexcel("getIdFromColumnName",l,!0),0<t?l[0]-e[0]:e[0]-l[0]}),n=0;n<l.length;n++)if(l[n]){var c=$.fn.jexcel("getIdFromColumnName",l[n],!0),o=c[0]+t;o<0&&(o=0);var s=$.fn.jexcel("getColumnName",o);e=e.replace(new RegExp(l[n],"g"),s+(c[1]+1))}return e},shiftFormulaByRow:function(e,t){t||(t=1);for(var l=excelFormulaUtilities.formula2JavaScript(e).match(/([A-Z]+[0-9]+)*/g).filter(function(e){return""!=e}).sort(function(e,l){return e=$.fn.jexcel("getIdFromColumnName",e,!0),l=$.fn.jexcel("getIdFromColumnName",l,!0),0<t?l[1]-e[1]:e[1]-l[1]}),n=0;n<l.length;n++)if(l[n]){var c=$.fn.jexcel("getIdFromColumnName",l[n],!0),o=""+$.fn.jexcel("getColumnName",c[0]),s=c[1]+1+t;s<1&&(s=1),e=e.replace(new RegExp(l[n],"g"),o+s)}return e},row:function(e){e||(e=$.fn.jexcel.selectedCell);var l=!1;return $(e).length&&(l=(l=$(e).prop("id").split("-"))[1]),l},col:function(e){e||(e=$.fn.jexcel.selectedCell);var l=!1;return $(e).length&&(l=(l=$(e).prop("id").split("-"))[0]),l},getEventsFlag:function(e){return!!$.fn.jexcel.ignoreEvents},setEventsFlag:function(e){$.fn.jexcel.ignoreEvents=!!e},getHistoryFlag:function(e){return!!$.fn.jexcel.ignoreHistory},setHistoryFlag:function(e){$.fn.jexcel.ignoreHistory=!!e},showFilter:function(){$(this).find(".jexcel-filter").css("display","")},hideFilter:function(){$(this).find(".jexcel-filter").css("display","none")},getComments:function(e){if("string"==typeof e)e=$(this).jexcel("getCell",e);return $(e).prop("title")},setComments:function(e,l){if("string"==typeof e)e=$(this).jexcel("getCell",e);$(e).prop("title",l),l?$(e).addClass("jexcel_comments"):$(e).removeClass("jexcel_comments")},getConfig:function(e,l){var t=$(this).prop("id");return $.fn.jexcel.defaults[t][e]},setConfig:function(e,l){var t=$(this).prop("id");$.fn.jexcel.defaults[t][e]=l},getRowCount:function(){var e=$(this).prop("id");return $.fn.jexcel.defaults[e].data.length},getMeta:function(e,l){if(e)return e=$(this).jexcel("getCell",e),l?$(e).data(l):$(e).data();var t={},n=$(this).prop("id"),c=$.fn.jexcel.defaults[n].data[0].length,o=$.fn.jexcel.defaults[n].data.length;for(j=0;j<o;j++)for(i=0;i<c;i++){e=$(this).find(".jexcel-content #"+i+"-"+j);var s=l?$(e).data(l):$(e).data();if(Object.keys(s).length)t[$.fn.jexcel("getColumnName",i)+(parseInt(j)+1)]=s}return t},setMeta:function(e,l,t){var n=$(this);if(l&&t){var c=$(this).jexcel("getCell",e);$(c).data(l,t)}else $.each(e,function(e,l){var t=Object.keys(l)[0];(t=$(n).jexcel("getCell",t))&&$(t).data(l[Object.keys(l)[0]])})},getStyle:function(e,l){if(e)return e=$(this).jexcel("getCell",e),l?$(e).css(l):$(e).attr("style");var t={},n=$(this).prop("id"),c=$.fn.jexcel.defaults[n].data[0].length,o=$.fn.jexcel.defaults[n].data.length;for(j=0;j<o;j++)for(i=0;i<c;i++){e=$(this).find("#"+i+"-"+j);var s=l?$(e).css(l):$(e).attr("style");if(s)t[$.fn.jexcel("getColumnName",i)+(parseInt(j)+1)]=s}return t},setStyle:function(e,o,s){var r=$(this),a=[],i=[];if(o&&s){if("string"==typeof e)e=$(this).jexcel("getCell",e);$.each(e,function(e,l){var t=$(l).prop("id"),n=[],c=$(l).attr("style");n[t]=""+(c||""),a.push(n),"font-weight"==o&&"bold"==s?"700"==$(l).css(o)||"bold"==$(l).css(o)?$(l).css(o,""):$(l).css(o,s):$(l).css(o)==s?$(l).css(o,""):$(l).css(o,s);n=[],c=$(l).attr("style");n[t]=""+(c||""),i.push(n)})}else $.each(e,function(e,l){var t=$(r).jexcel("getCell",Object.keys(l)[0]);if(t){var n=$(t).prop("id"),c=[],o=$(t).attr("style");c[n]=""+(o||""),a.push(c),$(t).attr("style",l[Object.keys(l)[0]]);c=[],o=$(t).attr("style");c[n]=""+(o||""),i.push(c)}});$(this).jexcel("setHistory",null,{type:"setStyle",fr:a,to:i})},contextMenu:function(e,l,t){var n="";return"col"==e?(1==$.fn.jexcel.defaults[$.fn.jexcel.current].allowInsertColumn&&(n+="<a onclick=\"jQuery('#"+$.fn.jexcel.current+"').jexcel('insertColumn', 1, null, "+l+')">Insert a new column<span></span></a>'),1==$.fn.jexcel.defaults[$.fn.jexcel.current].allowDeleteColumn&&(n+="<a onclick=\"jQuery('#"+$.fn.jexcel.current+"').jexcel('deleteColumn')\">Delete this column<span></span></a>"),n+="<a onclick=\"jQuery('#"+$.fn.jexcel.current+"').jexcel('setHeader', "+l+')">Rename this column</a>',n+="<hr>",1==$.fn.jexcel.defaults[$.fn.jexcel.current].columnSorting&&(n+="<a onclick=\"jQuery('#"+$.fn.jexcel.current+"').jexcel('orderBy', "+l+', 0)">Order ascending <span></span></a>',n+="<a onclick=\"jQuery('#"+$.fn.jexcel.current+"').jexcel('orderBy', "+l+', 1)">Order descending <span></span></a>'),n+="<hr><a onclick=\"jQuery('#"+$.fn.jexcel.current+"').jexcel('copy', true)\">Copy...<span>Ctrl + C</span></a>"):(1==$.fn.jexcel.defaults[$.fn.jexcel.current].allowInsertRow&&(n+="<a onclick=\"jQuery('#"+$.fn.jexcel.current+"').jexcel('insertRow', 1, "+l+')">Insert a new row<span></span></a>'),1==$.fn.jexcel.defaults[$.fn.jexcel.current].allowDeleteRow&&(n+="<a onclick=\"jQuery('#"+$.fn.jexcel.current+"').jexcel('deleteRow')\">Delete this row<span></span></a>"),n+="<hr>",1==$.fn.jexcel.defaults[$.fn.jexcel.current].allowComments&&($($.fn.jexcel.selectedCell).prop("title")?(n+="<a onclick=\"jQuery('#"+$.fn.jexcel.current+"').jexcel('setComments', $.fn.jexcel.selectedCell, prompt('Comments', $($.fn.jexcel.selectedCell).prop('title')));\">Edit comments<span></span></a>",n+="<a onclick=\"jQuery('#"+$.fn.jexcel.current+"').jexcel('setComments', $.fn.jexcel.selectedCell, '');\">Reset comments<span></span></a><hr>"):n+="<a onclick=\"jQuery('#"+$.fn.jexcel.current+"').jexcel('setComments', $.fn.jexcel.selectedCell, prompt('Comments', ''));\">Add comments<span></span></a><hr>"),n+="<a onclick=\"jQuery('#"+$.fn.jexcel.current+"').jexcel('copy', true)\">Copy...<span>Ctrl + C</span></a>"),n+="<a onclick=\"jQuery('#"+$.fn.jexcel.current+"').jexcel('download')\">Save as...<span>Ctrl + S</span></a>",$.fn.jexcel.defaults[$.fn.jexcel.current].about&&(n+="<a onclick=\"alert('"+$.fn.jexcel.defaults[$.fn.jexcel.current].about+"')\">About<span></span></a>"),n},hash:function(e){var l,t=0;if(0===e.length)return t;for(l=0;l<e.length;l++)t=(t<<5)-t+e.charCodeAt(l),t|=0;return t},parseTable:function(e,l){if("TABLE"==e.tagName){var t=$(e).find("thead tr");t=$(t[t.length-1]).find("td, th"),options={columns:[],colWidths:[],colHeaders:[],colAligments:[],data:[]};for(var n=0;n<t.length;n++)options.columns.push({type:"text"}),options.colWidths.push($(t[n]).width()+50),options.colHeaders.push($(t[n]).text()),options.colAligments.push($(t[n]).css("text-align"));for(var c=$(e).find("table > tr, tbody tr"),o=0;o<c.length;o++){var s=$(c[o]).find("td");options.data[o]=[];for(n=0;n<s.length;n++){var r=$(s[n]).text();options.data[o].push(r)}}var a=[];for(n=0;n<options.columns.length;n++){test=!0,testCalendar=!0,a[n]=[];for(o=0;o<options.data.length;o++){r=options.data[o][n];a[n][r]||(a[n][r]=0),a[n][r]++,25<r.length&&(test=!1),10==r.length&&"-"==r.substr(4,1)&&"-"==r.substr(7,1)||(testCalendar=!1)}testCalendar?options.columns[n].type="calendar":1==test&&Object.keys(a[n]).length<=parseInt(.1*options.data.length)&&(options.columns[n].type="dropdown",options.columns[n].source=Object.keys(a[n]))}return l&&$(e).remove(),options}console.log("Element is not a table")},destroy:function(){var e=$(this).prop("id");$.fn.jexcel.defaults[e]&&(delete $.fn.jexcel.defaults[e],$(this).html(""),$(".jexcel_corner").remove(),$(".jexcel_textarea").remove(),$(".jexcel_contextmenu").remove(),$(".jexcel_about").remove(),$.fn.jexcel.current==e&&($.fn.jexcel.current=null)),Object.keys($.fn.jexcel.defaults).length||($(document).off("dragstart",$.fn.jexcel.dragStartControls),$(document).off("contextmenu",$.fn.jexcel.contextMenuControls),$(document).off("mousewheel",$.fn.jexcel.mouseWheelControls),$(document).off("mousedown touchstart",$.fn.jexcel.mouseDownControls),$(document).off("mouseup",$.fn.jexcel.mouseUpControls),$(document).off("dblclick touchend",$.fn.jexcel.doubleClickControls),$(document).off("mousemove",$.fn.jexcel.mouseMoveControls),$(document).off("mouseover",$.fn.jexcel.mouseOverControls),$(document).off("paste",$.fn.jexcel.pasteControls),$(document).off("keydown",$.fn.jexcel.keyDownControls),$.fn.jexcel.defaults=null,$.fn.jexcel.current=null,$.fn.jexcel.factory=null,$.fn.jexcel.hash=null,$.fn.jexcel.style=null,$.fn.jexcel.selectedCorner=null,$.fn.jexcel.selectedHeader=null,$.fn.jexcel.resizeColumn=null,$.fn.jexcel.dragStartControls=null,$.fn.jexcel.contextMenuControls=null,$.fn.jexcel.mouseWheelControls=null,$.fn.jexcel.mouseDownControls=null,$.fn.jexcel.mouseUpControls=null,$.fn.jexcel.doubleClickControls=null,$.fn.jexcel.mouseMoveControls=null,$.fn.jexcel.mouseOverControls=null,$.fn.jexcel.pasteControls=null,$.fn.jexcel.keyDownControls=null,$.fn.jexcel.touchControls=null)}};$.fn.jexcel=function(e){return methods[e]?methods[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist on jQuery.tooltip"):methods.init.apply(this,arguments)}}(jQuery);